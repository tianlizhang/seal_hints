2022-11-29 23:46:34 - INFO - python 22_fuse.py --dataset acm --k 1000 --log acm_22fuse --gid 2
2022-11-29 23:46:34 - INFO - Namespace(log='acm_22fuse', gid=2, dataset='acm', data_path='../preprocess/data/acm/', train_start=2000, train_end=2011, valid_start=2011, valid_end=2012, node_year=5, train_num=3000, num_ngh=[100, 20, 1, 15], val_percent=100, k=1000, epochs=700, bs=4096, lr=0.0005, embed_dim=128, hidden_channels=128, hidden_dims=[20, 10, 20, 8], num_layers=3, dropout=0, edge_gnn='sage', node_gnn='sage', node_predictor='cites', fusion_mode='cat', beta=0.5, alpha=0.5, valid_freq=1, only_papers=False, save_dir='../save', device=device(type='cuda', index=2), num_rels=4)
2022-11-29 23:46:43 - INFO - all_g: Data(x=[1075859, 128], edge_index=[2, 6221766], edge_attr=[6221766], num_nodes=1075859, ts_infos=[12, 3], raw_nid=[1075859], train_val_split=5561958)
2022-11-30 00:02:34 - INFO - epoch: 0, valid: {2011: {'mrr': 0.08371565490961075, 'hits@1,3,10': [0.03272123262286186, 0.07413501292467117, 0.17191065847873688], 'ndcg,@100': [0.2298316499738996, 0.18703547486645547], 'male': 0.3641, 'rmsle': 0.473, 'cor': 0.3782}}, train: {'mrr': 0.9503, 'cor': 0.4275, 'loss': 0.3925}
2022-11-30 00:20:56 - INFO - epoch: 1, valid: {2011: {'mrr': 0.14155426621437073, 'hits@1,3,10': [0.053397078067064285, 0.13842882215976715, 0.3333436846733093], 'ndcg,@100': [0.29421611921936114, 0.27267997199073374], 'male': 0.3526, 'rmsle': 0.4648, 'cor': 0.3943}}, train: {'mrr': 0.9886, 'cor': 0.4883, 'loss': 0.2476}
2022-11-30 00:38:41 - INFO - epoch: 2, valid: {2011: {'mrr': 0.2653034031391144, 'hits@1,3,10': [0.13861508667469025, 0.2993030548095703, 0.5446657538414001], 'ndcg,@100': [0.4064129391457638, 0.3930837849598045], 'male': 0.3509, 'rmsle': 0.4695, 'cor': 0.4019}}, train: {'mrr': 0.9951, 'cor': 0.5, 'loss': 0.1839}
2022-11-30 00:56:41 - INFO - epoch: 3, valid: {2011: {'mrr': 0.31235837936401367, 'hits@1,3,10': [0.17515483498573303, 0.3599025309085846, 0.6101858019828796], 'ndcg,@100': [0.44720263111605646, 0.4350234895827332], 'male': 0.3511, 'rmsle': 0.473, 'cor': 0.4063}}, train: {'mrr': 0.9973, 'cor': 0.5069, 'loss': 0.159}
2022-11-30 01:14:47 - INFO - epoch: 4, valid: {2011: {'mrr': 0.36929187178611755, 'hits@1,3,10': [0.22800862789154053, 0.4304363429546356, 0.6680067777633667], 'ndcg,@100': [0.4947404709266317, 0.4836101011577891], 'male': 0.344, 'rmsle': 0.4672, 'cor': 0.4079}}, train: {'mrr': 0.998, 'cor': 0.512, 'loss': 0.145}
2022-11-30 01:32:41 - INFO - epoch: 5, valid: {2011: {'mrr': 0.3730317950248718, 'hits@1,3,10': [0.22603727877140045, 0.4398273825645447, 0.6862611174583435], 'ndcg,@100': [0.4986900057487398, 0.4876800532743114], 'male': 0.3442, 'rmsle': 0.4698, 'cor': 0.4096}}, train: {'mrr': 0.9984, 'cor': 0.5162, 'loss': 0.1378}
2022-11-30 01:50:37 - INFO - epoch: 6, valid: {2011: {'mrr': 0.40101349353790283, 'hits@1,3,10': [0.251431941986084, 0.4757307171821594, 0.7126336693763733], 'ndcg,@100': [0.5220748530019469, 0.5115163897223424], 'male': 0.3416, 'rmsle': 0.4679, 'cor': 0.4109}}, train: {'mrr': 0.9986, 'cor': 0.5197, 'loss': 0.1319}
2022-11-30 02:07:11 - INFO - epoch: 7, valid: {2011: {'mrr': 0.41200268268585205, 'hits@1,3,10': [0.2624683678150177, 0.48935937881469727, 0.7189668416976929], 'ndcg,@100': [0.5307880379155802, 0.5199119833005813], 'male': 0.3439, 'rmsle': 0.471, 'cor': 0.4121}}, train: {'mrr': 0.9988, 'cor': 0.5228, 'loss': 0.1273}
2022-11-30 02:23:36 - INFO - epoch: 8, valid: {2011: {'mrr': 0.42259255051612854, 'hits@1,3,10': [0.2729615271091461, 0.5019635558128357, 0.7300653457641602], 'ndcg,@100': [0.5395921981671615, 0.5290477379817279], 'male': 0.3475, 'rmsle': 0.4758, 'cor': 0.4125}}, train: {'mrr': 0.9989, 'cor': 0.5251, 'loss': 0.1242}
2022-11-30 02:40:46 - INFO - epoch: 9, valid: {2011: {'mrr': 0.4313892126083374, 'hits@1,3,10': [0.28241467475891113, 0.5120376348495483, 0.7347686290740967], 'ndcg,@100': [0.5465788928433043, 0.5359847671319885], 'male': 0.3463, 'rmsle': 0.4763, 'cor': 0.4118}}, train: {'mrr': 0.999, 'cor': 0.5274, 'loss': 0.1221}
2022-11-30 03:00:05 - INFO - epoch: 10, valid: {2011: {'mrr': 0.4343995749950409, 'hits@1,3,10': [0.28468093276023865, 0.5172531604766846, 0.7365381717681885], 'ndcg,@100': [0.5489829062909427, 0.5383553928728734], 'male': 0.3455, 'rmsle': 0.476, 'cor': 0.4139}}, train: {'mrr': 0.9991, 'cor': 0.5293, 'loss': 0.12}
2022-11-30 03:17:04 - INFO - epoch: 11, valid: {2011: {'mrr': 0.44424715638160706, 'hits@1,3,10': [0.294941246509552, 0.5281032919883728, 0.7454946041107178], 'ndcg,@100': [0.5571155733928967, 0.546640989805045], 'male': 0.3478, 'rmsle': 0.4813, 'cor': 0.4129}}, train: {'mrr': 0.9991, 'cor': 0.531, 'loss': 0.1183}
2022-11-30 03:40:42 - INFO - epoch: 12, valid: {2011: {'mrr': 0.459623783826828, 'hits@1,3,10': [0.31114664673805237, 0.5455815196037292, 0.7539543509483337], 'ndcg,@100': [0.5692312190484192, 0.5582611314136668], 'male': 0.3489, 'rmsle': 0.4863, 'cor': 0.4132}}, train: {'mrr': 0.9991, 'cor': 0.5331, 'loss': 0.1162}
2022-11-30 03:57:32 - INFO - epoch: 13, valid: {2011: {'mrr': 0.4662770926952362, 'hits@1,3,10': [0.31893888115882874, 0.5522406697273254, 0.7573847770690918], 'ndcg,@100': [0.5745623590385278, 0.563779986857206], 'male': 0.3521, 'rmsle': 0.4892, 'cor': 0.4149}}, train: {'mrr': 0.9992, 'cor': 0.535, 'loss': 0.1146}
2022-11-30 04:22:32 - INFO - epoch: 14, valid: {2011: {'mrr': 0.48353999853134155, 'hits@1,3,10': [0.3388230800628662, 0.5716281533241272, 0.7675674557685852], 'ndcg,@100': [0.5883253270540563, 0.5775719538793221], 'male': 0.3527, 'rmsle': 0.4939, 'cor': 0.4153}}, train: {'mrr': 0.9992, 'cor': 0.537, 'loss': 0.1129}
2022-11-30 04:41:35 - INFO - epoch: 15, valid: {2011: {'mrr': 0.49438345432281494, 'hits@1,3,10': [0.3529174327850342, 0.5806466341018677, 0.7699424028396606], 'ndcg,@100': [0.5968525942219685, 0.5864037078413551], 'male': 0.3509, 'rmsle': 0.4908, 'cor': 0.4146}}, train: {'mrr': 0.9992, 'cor': 0.5387, 'loss': 0.1116}
2022-11-30 05:08:55 - INFO - epoch: 16, valid: {2011: {'mrr': 0.4897274374961853, 'hits@1,3,10': [0.345466673374176, 0.5776197910308838, 0.7725812196731567], 'ndcg,@100': [0.5935143268694093, 0.5830852769373303], 'male': 0.3555, 'rmsle': 0.4936, 'cor': 0.4151}}, train: {'mrr': 0.9993, 'cor': 0.54, 'loss': 0.1104}
2022-11-30 05:28:03 - INFO - epoch: 17, valid: {2011: {'mrr': 0.49901488423347473, 'hits@1,3,10': [0.3577604293823242, 0.5854586362838745, 0.772891640663147], 'ndcg,@100': [0.6002927442699323, 0.5893845810849514], 'male': 0.3582, 'rmsle': 0.5029, 'cor': 0.416}}, train: {'mrr': 0.9993, 'cor': 0.5418, 'loss': 0.1091}
2022-11-30 05:53:02 - INFO - epoch: 18, valid: {2011: {'mrr': 0.5078703165054321, 'hits@1,3,10': [0.3660649061203003, 0.5973332524299622, 0.7783244848251343], 'ndcg,@100': [0.6076599674509715, 0.5969018718425861], 'male': 0.356, 'rmsle': 0.5003, 'cor': 0.4127}}, train: {'mrr': 0.9993, 'cor': 0.5435, 'loss': 0.108}
2022-11-30 06:12:18 - INFO - epoch: 19, valid: {2011: {'mrr': 0.496903657913208, 'hits@1,3,10': [0.3523120582103729, 0.5878801345825195, 0.7760582566261292], 'ndcg,@100': [0.5989417669111738, 0.5879705376861235], 'male': 0.3551, 'rmsle': 0.5047, 'cor': 0.4137}}, train: {'mrr': 0.9993, 'cor': 0.545, 'loss': 0.1068}
2022-11-30 06:29:33 - INFO - epoch: 20, valid: {2011: {'mrr': 0.5135217308998108, 'hits@1,3,10': [0.37259984016418457, 0.6024711728096008, 0.7834003567695618], 'ndcg,@100': [0.6123293659212795, 0.601849310719269], 'male': 0.3564, 'rmsle': 0.5032, 'cor': 0.4128}}, train: {'mrr': 0.9994, 'cor': 0.5466, 'loss': 0.1057}
2022-11-30 06:48:50 - INFO - epoch: 21, valid: {2011: {'mrr': 0.5210497379302979, 'hits@1,3,10': [0.38109061121940613, 0.6105117797851562, 0.7875758409500122], 'ndcg,@100': [0.6180662249615804, 0.6071463294037396], 'male': 0.352, 'rmsle': 0.5037, 'cor': 0.4127}}, train: {'mrr': 0.9994, 'cor': 0.5476, 'loss': 0.1049}
2022-11-30 07:07:47 - INFO - epoch: 22, valid: {2011: {'mrr': 0.5223178863525391, 'hits@1,3,10': [0.3815407454967499, 0.6132126450538635, 0.789717972278595], 'ndcg,@100': [0.6193291908709949, 0.6087440010174555], 'male': 0.3616, 'rmsle': 0.5089, 'cor': 0.4141}}, train: {'mrr': 0.9994, 'cor': 0.5487, 'loss': 0.1041}
2022-11-30 07:27:27 - INFO - epoch: 23, valid: {2011: {'mrr': 0.5326944589614868, 'hits@1,3,10': [0.3950141966342926, 0.6242180466651917, 0.7910528779029846], 'ndcg,@100': [0.6270770282293493, 0.6159825104906207], 'male': 0.3561, 'rmsle': 0.5119, 'cor': 0.4144}}, train: {'mrr': 0.9994, 'cor': 0.5502, 'loss': 0.1031}
2022-11-30 07:46:14 - INFO - epoch: 24, valid: {2011: {'mrr': 0.5390685796737671, 'hits@1,3,10': [0.4027133285999298, 0.6298216581344604, 0.7949489951133728], 'ndcg,@100': [0.6322378838651266, 0.6213286908782589], 'male': 0.3475, 'rmsle': 0.5056, 'cor': 0.4154}}, train: {'mrr': 0.9994, 'cor': 0.5512, 'loss': 0.1023}
2022-11-30 08:12:48 - INFO - epoch: 25, valid: {2011: {'mrr': 0.5504561066627502, 'hits@1,3,10': [0.4186703562736511, 0.6384055614471436, 0.7972928881645203], 'ndcg,@100': [0.6409464265741952, 0.6300340602377328], 'male': 0.3471, 'rmsle': 0.4984, 'cor': 0.4141}}, train: {'mrr': 0.9994, 'cor': 0.5524, 'loss': 0.1015}
2022-11-30 08:29:48 - INFO - epoch: 26, valid: {2011: {'mrr': 0.5434114933013916, 'hits@1,3,10': [0.4106452763080597, 0.6303804516792297, 0.7930707931518555], 'ndcg,@100': [0.6352385894434068, 0.6241157128262581], 'male': 0.3525, 'rmsle': 0.504, 'cor': 0.415}}, train: {'mrr': 0.9995, 'cor': 0.5523, 'loss': 0.1007}
2022-11-30 08:59:51 - INFO - epoch: 27, valid: {2011: {'mrr': 0.5473510026931763, 'hits@1,3,10': [0.4141533374786377, 0.6354718208312988, 0.7965788841247559], 'ndcg,@100': [0.6386730397237469, 0.6278614518564554], 'male': 0.3597, 'rmsle': 0.5132, 'cor': 0.4158}}, train: {'mrr': 0.9995, 'cor': 0.5544, 'loss': 0.0999}
2022-11-30 09:19:08 - INFO - epoch: 28, valid: {2011: {'mrr': 0.5471177101135254, 'hits@1,3,10': [0.413594514131546, 0.6357667446136475, 0.7984725832939148], 'ndcg,@100': [0.638288638554834, 0.6271511618161113], 'male': 0.3597, 'rmsle': 0.5171, 'cor': 0.4155}}, train: {'mrr': 0.9995, 'cor': 0.556, 'loss': 0.0992}
2022-11-30 09:43:36 - INFO - epoch: 29, valid: {2011: {'mrr': 0.5530005097389221, 'hits@1,3,10': [0.42124706506729126, 0.6420378088951111, 0.7983173727989197], 'ndcg,@100': [0.6426694685053147, 0.6313487509770545], 'male': 0.3614, 'rmsle': 0.5112, 'cor': 0.413}}, train: {'mrr': 0.9995, 'cor': 0.5573, 'loss': 0.0983}
2022-11-30 10:02:18 - INFO - epoch: 30, valid: {2011: {'mrr': 0.5620887875556946, 'hits@1,3,10': [0.4338512718677521, 0.6479518413543701, 0.8003507852554321], 'ndcg,@100': [0.6499170535575005, 0.6390177691258561], 'male': 0.3553, 'rmsle': 0.5081, 'cor': 0.415}}, train: {'mrr': 0.9995, 'cor': 0.5583, 'loss': 0.0978}
2022-11-30 10:21:01 - INFO - epoch: 31, valid: {2011: {'mrr': 0.5459485054016113, 'hits@1,3,10': [0.4123527407646179, 0.6355804800987244, 0.795632004737854], 'ndcg,@100': [0.6374070587787649, 0.6264484323704191], 'male': 0.3512, 'rmsle': 0.5052, 'cor': 0.4144}}, train: {'mrr': 0.9995, 'cor': 0.5599, 'loss': 0.097}
2022-11-30 10:37:47 - INFO - epoch: 32, valid: {2011: {'mrr': 0.5574570894241333, 'hits@1,3,10': [0.42722320556640625, 0.6459339261054993, 0.7978206276893616], 'ndcg,@100': [0.6460325209227934, 0.6347063972216452], 'male': 0.3568, 'rmsle': 0.511, 'cor': 0.4138}}, train: {'mrr': 0.9995, 'cor': 0.5603, 'loss': 0.0965}
2022-11-30 10:56:03 - INFO - epoch: 33, valid: {2011: {'mrr': 0.548917829990387, 'hits@1,3,10': [0.41461899876594543, 0.6400819420814514, 0.7977275252342224], 'ndcg,@100': [0.6396902261003313, 0.6286618776868516], 'male': 0.3503, 'rmsle': 0.502, 'cor': 0.413}}, train: {'mrr': 0.9995, 'cor': 0.56, 'loss': 0.0961}
2022-11-30 11:14:25 - INFO - epoch: 34, valid: {2011: {'mrr': 0.5632781982421875, 'hits@1,3,10': [0.4343479871749878, 0.650978684425354, 0.8017323017120361], 'ndcg,@100': [0.6509194493885565, 0.639962949945769], 'male': 0.3425, 'rmsle': 0.4798, 'cor': 0.4113}}, train: {'mrr': 0.9995, 'cor': 0.5607, 'loss': 0.0959}
2022-11-30 11:32:23 - INFO - epoch: 35, valid: {2011: {'mrr': 0.5662034153938293, 'hits@1,3,10': [0.43796470761299133, 0.654471218585968, 0.8006767630577087], 'ndcg,@100': [0.6530305703993036, 0.6419756705775221], 'male': 0.3453, 'rmsle': 0.5013, 'cor': 0.4143}}, train: {'mrr': 0.9995, 'cor': 0.562, 'loss': 0.0949}
2022-11-30 11:54:18 - INFO - epoch: 36, valid: {2011: {'mrr': 0.5609532594680786, 'hits@1,3,10': [0.43056049942970276, 0.649628221988678, 0.8008009791374207], 'ndcg,@100': [0.6490745893715429, 0.6380433048892403], 'male': 0.3465, 'rmsle': 0.5016, 'cor': 0.4138}}, train: {'mrr': 0.9995, 'cor': 0.5638, 'loss': 0.0942}
2022-11-30 12:12:11 - INFO - epoch: 37, valid: {2011: {'mrr': 0.5706858038902283, 'hits@1,3,10': [0.4432578384876251, 0.6577619910240173, 0.8038278222084045], 'ndcg,@100': [0.6566061294167019, 0.6453949179957873], 'male': 0.3377, 'rmsle': 0.4848, 'cor': 0.4105}}, train: {'mrr': 0.9996, 'cor': 0.5646, 'loss': 0.0936}
2022-11-30 12:38:19 - INFO - epoch: 38, valid: {2011: {'mrr': 0.5700841546058655, 'hits@1,3,10': [0.4418452978134155, 0.6588175296783447, 0.805069625377655], 'ndcg,@100': [0.6563399772390504, 0.6452886639396461], 'male': 0.3237, 'rmsle': 0.4705, 'cor': 0.4109}}, train: {'mrr': 0.9996, 'cor': 0.5655, 'loss': 0.0933}
2022-11-30 12:55:00 - INFO - epoch: 39, valid: {2011: {'mrr': 0.575869619846344, 'hits@1,3,10': [0.44983935356140137, 0.662930965423584, 0.8060785531997681], 'ndcg,@100': [0.6607707637661789, 0.6497538509384341], 'male': 0.3296, 'rmsle': 0.4781, 'cor': 0.4101}}, train: {'mrr': 0.9996, 'cor': 0.5647, 'loss': 0.0929}
2022-11-30 13:14:00 - INFO - epoch: 40, valid: {2011: {'mrr': 0.5769739151000977, 'hits@1,3,10': [0.45112770795822144, 0.6643279790878296, 0.806420087814331], 'ndcg,@100': [0.6615518024046582, 0.650450467050004], 'male': 0.3335, 'rmsle': 0.483, 'cor': 0.411}}, train: {'mrr': 0.9996, 'cor': 0.5662, 'loss': 0.0926}
2022-11-30 13:31:52 - INFO - epoch: 41, valid: {2011: {'mrr': 0.5699805617332458, 'hits@1,3,10': [0.44023096561431885, 0.660198986530304, 0.8078636527061462], 'ndcg,@100': [0.6566245992516814, 0.6461048524164155], 'male': 0.3273, 'rmsle': 0.4812, 'cor': 0.4133}}, train: {'mrr': 0.9996, 'cor': 0.5674, 'loss': 0.0919}
2022-11-30 13:43:52 - INFO - epoch: 42, valid: {2011: {'mrr': 0.5804582238197327, 'hits@1,3,10': [0.45514801144599915, 0.6670444011688232, 0.8072582483291626], 'ndcg,@100': [0.6644273483685246, 0.6535497071430153], 'male': 0.3343, 'rmsle': 0.4887, 'cor': 0.4119}}, train: {'mrr': 0.9996, 'cor': 0.5684, 'loss': 0.0914}
2022-11-30 14:07:34 - INFO - epoch: 43, valid: {2011: {'mrr': 0.5802063345909119, 'hits@1,3,10': [0.45378202199935913, 0.6691864728927612, 0.8084689974784851], 'ndcg,@100': [0.6643515081595499, 0.6536166593015397], 'male': 0.3257, 'rmsle': 0.4778, 'cor': 0.4092}}, train: {'mrr': 0.9996, 'cor': 0.5674, 'loss': 0.0915}
2022-11-30 14:19:20 - INFO - epoch: 44, valid: {2011: {'mrr': 0.5841890573501587, 'hits@1,3,10': [0.4608291983604431, 0.6688604950904846, 0.808593213558197], 'ndcg,@100': [0.6673527827430987, 0.6565569562080662], 'male': 0.3323, 'rmsle': 0.4975, 'cor': 0.4126}}, train: {'mrr': 0.9996, 'cor': 0.5686, 'loss': 0.0908}
2022-11-30 14:30:37 - INFO - epoch: 45, valid: {2011: {'mrr': 0.5873492956161499, 'hits@1,3,10': [0.46495816111564636, 0.6715614199638367, 0.8092296123504639], 'ndcg,@100': [0.6696980727185311, 0.6587460113581675], 'male': 0.3317, 'rmsle': 0.4943, 'cor': 0.4114}}, train: {'mrr': 0.9996, 'cor': 0.5684, 'loss': 0.0903}
2022-11-30 14:42:14 - INFO - epoch: 46, valid: {2011: {'mrr': 0.5823201537132263, 'hits@1,3,10': [0.45879578590393066, 0.6686587333679199, 0.8052869439125061], 'ndcg,@100': [0.6654278776102598, 0.6541496882658262], 'male': 0.3374, 'rmsle': 0.502, 'cor': 0.4106}}, train: {'mrr': 0.9996, 'cor': 0.5705, 'loss': 0.0902}
2022-11-30 14:53:31 - INFO - epoch: 47, valid: {2011: {'mrr': 0.5822896361351013, 'hits@1,3,10': [0.45831456780433655, 0.6669512391090393, 0.8063890337944031], 'ndcg,@100': [0.665662574137018, 0.6546258193881053], 'male': 0.3339, 'rmsle': 0.5019, 'cor': 0.4111}}, train: {'mrr': 0.9996, 'cor': 0.5709, 'loss': 0.0896}
2022-11-30 15:11:48 - INFO - epoch: 48, valid: {2011: {'mrr': 0.577313244342804, 'hits@1,3,10': [0.4504912793636322, 0.6655076742172241, 0.8068081140518188], 'ndcg,@100': [0.6620490587871567, 0.6513389518246014], 'male': 0.3354, 'rmsle': 0.5069, 'cor': 0.41}}, train: {'mrr': 0.9996, 'cor': 0.5724, 'loss': 0.0892}
2022-11-30 15:44:44 - INFO - epoch: 49, valid: {2011: {'mrr': 0.5864435434341431, 'hits@1,3,10': [0.46235039830207825, 0.6735948324203491, 0.8083603978157043], 'ndcg,@100': [0.669011644584335, 0.6579837218599968], 'male': 0.335, 'rmsle': 0.5039, 'cor': 0.4097}}, train: {'mrr': 0.9996, 'cor': 0.5729, 'loss': 0.0887}
2022-11-30 16:23:20 - INFO - epoch: 50, valid: {2011: {'mrr': 0.571834921836853, 'hits@1,3,10': [0.4429629147052765, 0.6616115570068359, 0.8043090105056763], 'ndcg,@100': [0.6576108849846213, 0.6464995091955201], 'male': 0.3208, 'rmsle': 0.48, 'cor': 0.4078}}, train: {'mrr': 0.9996, 'cor': 0.5736, 'loss': 0.0884}
