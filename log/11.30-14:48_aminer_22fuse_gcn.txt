2022-11-30 14:48:41 - INFO - python 22_fuse.py --dataset aminer --k 1000 --log aminer_22fuse_gcn --edge_gnn gcn
2022-11-30 14:48:41 - INFO - Namespace(log='aminer_22fuse_gcn', gid=2, dataset='aminer', data_path='../preprocess/data/aminer/', train_start=2000, train_end=2011, valid_start=2011, valid_end=2012, node_year=5, train_num=3000, num_ngh=[100, 20, 1, 15], val_percent=100, k=1000, epochs=700, bs=4096, lr=0.0005, embed_dim=128, hidden_channels=128, hidden_dims=[20, 10, 20, 8], num_layers=3, dropout=0, edge_gnn='gcn', node_gnn='sage', node_predictor='cites', fusion_mode='cat', beta=0.5, alpha=0.5, valid_freq=1, only_papers=False, save_dir='../save', device=device(type='cuda', index=2), num_rels=4)
2022-11-30 14:48:59 - INFO - all_g: Data(x=[1816165, 128], edge_index=[2, 13858687], edge_attr=[13858687], num_nodes=1816165, ts_infos=[12, 3], raw_nid=[1816165], train_val_split=12043677)
2022-11-30 16:01:54 - INFO - epoch: 0, valid: {2011: {'mrr': 0.1683751791715622, 'hits@1,3,10': [0.07714799791574478, 0.17901909351348877, 0.36814749240875244], 'ndcg,@100': [0.31065300026495857, 0.2795834153700239], 'male': 0.5285, 'rmsle': 0.6726, 'cor': 0.49}}, train: {'mrr': 0.9651, 'cor': 0.461, 'loss': 0.2922}
2022-11-30 17:06:35 - INFO - epoch: 1, valid: {2011: {'mrr': 0.25262975692749023, 'hits@1,3,10': [0.1398402452468872, 0.28877460956573486, 0.497367799282074], 'ndcg,@100': [0.38509156310285886, 0.35797588186831375], 'male': 0.5237, 'rmsle': 0.6658, 'cor': 0.5003}}, train: {'mrr': 0.9963, 'cor': 0.5537, 'loss': 0.1629}
2022-11-30 18:13:33 - INFO - epoch: 2, valid: {2011: {'mrr': 0.2854628562927246, 'hits@1,3,10': [0.16812561452388763, 0.33107805252075195, 0.5344372987747192], 'ndcg,@100': [0.41298924085081923, 0.38729686827779497], 'male': 0.5202, 'rmsle': 0.6634, 'cor': 0.5044}}, train: {'mrr': 0.9978, 'cor': 0.5643, 'loss': 0.1405}
2022-11-30 19:19:52 - INFO - epoch: 3, valid: {2011: {'mrr': 0.31486931443214417, 'hits@1,3,10': [0.19418609142303467, 0.3695699870586395, 0.5659870505332947], 'ndcg,@100': [0.4377374712562042, 0.41256842239765673], 'male': 0.5236, 'rmsle': 0.6674, 'cor': 0.5064}}, train: {'mrr': 0.9984, 'cor': 0.569, 'loss': 0.128}
2022-11-30 20:19:07 - INFO - epoch: 4, valid: {2011: {'mrr': 0.3338775038719177, 'hits@1,3,10': [0.21238647401332855, 0.39291316270828247, 0.5821388363838196], 'ndcg,@100': [0.45306494935824493, 0.4276180345691524], 'male': 0.5253, 'rmsle': 0.6697, 'cor': 0.5069}}, train: {'mrr': 0.9987, 'cor': 0.5723, 'loss': 0.1199}
2022-11-30 21:15:25 - INFO - epoch: 5, valid: {2011: {'mrr': 0.3507879376411438, 'hits@1,3,10': [0.22916439175605774, 0.41351473331451416, 0.5963088870048523], 'ndcg,@100': [0.4667682716732166, 0.44109530593193], 'male': 0.5288, 'rmsle': 0.6738, 'cor': 0.5095}}, train: {'mrr': 0.9989, 'cor': 0.5751, 'loss': 0.1152}
2022-11-30 22:39:40 - INFO - epoch: 6, valid: {2011: {'mrr': 0.3782658576965332, 'hits@1,3,10': [0.26104241609573364, 0.4423958361148834, 0.6091597676277161], 'ndcg,@100': [0.4882517395956533, 0.4621601184912979], 'male': 0.5325, 'rmsle': 0.6796, 'cor': 0.5093}}, train: {'mrr': 0.999, 'cor': 0.5777, 'loss': 0.1111}
2022-12-01 00:06:14 - INFO - epoch: 7, valid: {2011: {'mrr': 0.3880387544631958, 'hits@1,3,10': [0.26918214559555054, 0.4546692371368408, 0.6208009719848633], 'ndcg,@100': [0.496984622827034, 0.4718118147553818], 'male': 0.536, 'rmsle': 0.6816, 'cor': 0.5112}}, train: {'mrr': 0.9992, 'cor': 0.5798, 'loss': 0.1078}
2022-12-01 01:13:48 - INFO - epoch: 8, valid: {2011: {'mrr': 0.40044453740119934, 'hits@1,3,10': [0.2826652526855469, 0.46784234046936035, 0.6292689442634583], 'ndcg,@100': [0.5072451433760766, 0.48286862154179416], 'male': 0.542, 'rmsle': 0.6871, 'cor': 0.5126}}, train: {'mrr': 0.9992, 'cor': 0.582, 'loss': 0.1052}
2022-12-01 02:41:37 - INFO - epoch: 9, valid: {2011: {'mrr': 0.40683770179748535, 'hits@1,3,10': [0.2901241183280945, 0.47463253140449524, 0.6326366662979126], 'ndcg,@100': [0.5118477168549842, 0.4865728563620609], 'male': 0.5488, 'rmsle': 0.6924, 'cor': 0.5138}}, train: {'mrr': 0.9993, 'cor': 0.5838, 'loss': 0.1034}
2022-12-01 04:31:33 - INFO - epoch: 10, valid: {2011: {'mrr': 0.41333848237991333, 'hits@1,3,10': [0.29876840114593506, 0.48062029480934143, 0.6332324147224426], 'ndcg,@100': [0.5167374816288408, 0.4910870028597825], 'male': 0.5515, 'rmsle': 0.6964, 'cor': 0.5138}}, train: {'mrr': 0.9993, 'cor': 0.5855, 'loss': 0.1016}
2022-12-01 05:23:53 - INFO - epoch: 11, valid: {2011: {'mrr': 0.42327454686164856, 'hits@1,3,10': [0.30912694334983826, 0.49144691228866577, 0.6409831047058105], 'ndcg,@100': [0.5252031582161262, 0.5003834229089584], 'male': 0.5503, 'rmsle': 0.6962, 'cor': 0.515}}, train: {'mrr': 0.9994, 'cor': 0.5869, 'loss': 0.1}
2022-12-01 06:16:08 - INFO - epoch: 12, valid: {2011: {'mrr': 0.4289321303367615, 'hits@1,3,10': [0.3164399266242981, 0.4961702525615692, 0.6424663662910461], 'ndcg,@100': [0.5295172032609028, 0.5044200908815787], 'male': 0.5561, 'rmsle': 0.7039, 'cor': 0.514}}, train: {'mrr': 0.9994, 'cor': 0.5884, 'loss': 0.0989}
2022-12-01 07:08:23 - INFO - epoch: 13, valid: {2011: {'mrr': 0.43516111373901367, 'hits@1,3,10': [0.3241419494152069, 0.5018175840377808, 0.6454936861991882], 'ndcg,@100': [0.5345116144558791, 0.5096411456917522], 'male': 0.5595, 'rmsle': 0.7111, 'cor': 0.5137}}, train: {'mrr': 0.9994, 'cor': 0.5901, 'loss': 0.0976}
2022-12-01 08:00:33 - INFO - epoch: 14, valid: {2011: {'mrr': 0.43515342473983765, 'hits@1,3,10': [0.32418450713157654, 0.5029057264328003, 0.6450620889663696], 'ndcg,@100': [0.5343346946275425, 0.5090719733178898], 'male': 0.56, 'rmsle': 0.7131, 'cor': 0.5123}}, train: {'mrr': 0.9994, 'cor': 0.5913, 'loss': 0.0964}
2022-12-01 08:52:44 - INFO - epoch: 15, valid: {2011: {'mrr': 0.4442461133003235, 'hits@1,3,10': [0.336166113615036, 0.5109421014785767, 0.6472930312156677], 'ndcg,@100': [0.5413728939085677, 0.5161176592283756], 'male': 0.5627, 'rmsle': 0.718, 'cor': 0.5133}}, train: {'mrr': 0.9995, 'cor': 0.5925, 'loss': 0.0953}
2022-12-01 09:49:54 - INFO - epoch: 16, valid: {2011: {'mrr': 0.4418928623199463, 'hits@1,3,10': [0.33102941513061523, 0.5108873844146729, 0.6496516466140747], 'ndcg,@100': [0.539770006502158, 0.5145846905916932], 'male': 0.5655, 'rmsle': 0.721, 'cor': 0.5139}}, train: {'mrr': 0.9995, 'cor': 0.5938, 'loss': 0.0946}
2022-12-01 10:51:41 - INFO - epoch: 17, valid: {2011: {'mrr': 0.44294533133506775, 'hits@1,3,10': [0.33293819427490234, 0.5102065801620483, 0.6496881246566772], 'ndcg,@100': [0.5405487545115151, 0.5153068071881104], 'male': 0.564, 'rmsle': 0.7197, 'cor': 0.5137}}, train: {'mrr': 0.9995, 'cor': 0.595, 'loss': 0.0937}
2022-12-01 11:50:18 - INFO - epoch: 18, valid: {2011: {'mrr': 0.44392603635787964, 'hits@1,3,10': [0.3353211581707001, 0.51077800989151, 0.6476030945777893], 'ndcg,@100': [0.5409546838553073, 0.5152864592399375], 'male': 0.565, 'rmsle': 0.7219, 'cor': 0.5122}}, train: {'mrr': 0.9995, 'cor': 0.5963, 'loss': 0.0928}
2022-12-01 12:48:54 - INFO - epoch: 19, valid: {2011: {'mrr': 0.45007872581481934, 'hits@1,3,10': [0.34099280834198, 0.5172581672668457, 0.6542473435401917], 'ndcg,@100': [0.5464961838825981, 0.5216289156704358], 'male': 0.5668, 'rmsle': 0.7211, 'cor': 0.5122}}, train: {'mrr': 0.9995, 'cor': 0.5971, 'loss': 0.0922}
2022-12-01 13:42:32 - INFO - epoch: 20, valid: {2011: {'mrr': 0.4516032338142395, 'hits@1,3,10': [0.34533318877220154, 0.5173189640045166, 0.6500893831253052], 'ndcg,@100': [0.5467981140673127, 0.5209439341825334], 'male': 0.5666, 'rmsle': 0.7247, 'cor': 0.512}}, train: {'mrr': 0.9995, 'cor': 0.5984, 'loss': 0.0913}
2022-12-01 14:46:25 - INFO - epoch: 21, valid: {2011: {'mrr': 0.4520021378993988, 'hits@1,3,10': [0.34577086567878723, 0.5190027952194214, 0.6499921083450317], 'ndcg,@100': [0.5470755738802277, 0.521012770853026], 'male': 0.5729, 'rmsle': 0.7296, 'cor': 0.5126}}, train: {'mrr': 0.9995, 'cor': 0.5994, 'loss': 0.0907}
