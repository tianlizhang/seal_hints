2022-12-01 08:58:36 - INFO - python 21_mbsl.py --dataset dblp --k 1000 --log dblp_mbsl
2022-12-01 08:58:36 - INFO - Namespace(log='dblp_mbsl', gid=2, dataset='dblp', data_path='../preprocess/data/dblp/', train_start=2000, train_end=2011, valid_start=2011, valid_end=2012, node_year=5, train_num=3000, num_ngh=[100, 20, 1, 15], val_percent=100, k=1000, epochs=700, bs=4096, lr=0.0005, embed_dim=128, hidden_channels=128, num_layers=3, dropout=0, gnn='rgcn', method='cave', fusion_mode='cat', beta=0.5, alpha=0.5, valid_freq=1, only_papers=False, save_dir='../save', edge_gnn='sage', two_fuse=0, device=device(type='cuda', index=2), num_rels=4)
2022-12-01 08:59:53 - INFO - all_g: Data(x=[1880956, 128], edge_index=[2, 14090224], edge_attr=[14090224], num_nodes=1880956, ts_infos=[12, 3], raw_nid=[1880956], train_val_split=12284389)
2022-12-01 09:39:09 - INFO - epoch: 0, valid: {2011: {'mrr': 0.1400347501039505, 'hits@1,3,10': [0.05832422897219658, 0.1436348259449005, 0.3129308819770813], 'ndcg,@100': [0.285417729900753, 0.25377086070490296], 'male': 0.5889, 'rmsle': 0.7327, 'cor': 0.4739}}, train: {'mrr': 0.9652, 'cor': 0.5196, 'loss': 0.4291}
2022-12-01 10:17:06 - INFO - epoch: 1, valid: {2011: {'mrr': 0.29628506302833557, 'hits@1,3,10': [0.17953906953334808, 0.34136179089546204, 0.5412734746932983], 'ndcg,@100': [0.42332501923377164, 0.39967985894922997], 'male': 0.5858, 'rmsle': 0.7332, 'cor': 0.4781}}, train: {'mrr': 0.9962, 'cor': 0.5481, 'loss': 0.1892}
2022-12-01 10:55:43 - INFO - epoch: 2, valid: {2011: {'mrr': 0.32532644271850586, 'hits@1,3,10': [0.2069552093744278, 0.37575584650039673, 0.5715189576148987], 'ndcg,@100': [0.44745561502193026, 0.4240790891785486], 'male': 0.5764, 'rmsle': 0.7254, 'cor': 0.4787}}, train: {'mrr': 0.998, 'cor': 0.5528, 'loss': 0.1452}
2022-12-01 11:41:36 - INFO - epoch: 3, valid: {2011: {'mrr': 0.3598679304122925, 'hits@1,3,10': [0.23994651436805725, 0.41785600781440735, 0.6034358143806458], 'ndcg,@100': [0.4761512198658359, 0.4533964830098625], 'male': 0.5786, 'rmsle': 0.7274, 'cor': 0.4808}}, train: {'mrr': 0.9985, 'cor': 0.5556, 'loss': 0.1277}
2022-12-01 12:44:46 - INFO - epoch: 4, valid: {2011: {'mrr': 0.3864472806453705, 'hits@1,3,10': [0.26812073588371277, 0.44745686650276184, 0.6229249835014343], 'ndcg,@100': [0.4976031712071964, 0.47474558066155714], 'male': 0.5729, 'rmsle': 0.7213, 'cor': 0.4803}}, train: {'mrr': 0.9988, 'cor': 0.5573, 'loss': 0.1134}
2022-12-01 13:24:21 - INFO - epoch: 5, valid: {2011: {'mrr': 0.4008261263370514, 'hits@1,3,10': [0.2820048928260803, 0.46394357085227966, 0.636074960231781], 'ndcg,@100': [0.5098606104603304, 0.4877845170930917], 'male': 0.5725, 'rmsle': 0.7219, 'cor': 0.4829}}, train: {'mrr': 0.999, 'cor': 0.5592, 'loss': 0.1043}
2022-12-01 14:17:49 - INFO - epoch: 6, valid: {2011: {'mrr': 0.41452375054359436, 'hits@1,3,10': [0.29610395431518555, 0.48102715611457825, 0.6465328335762024], 'ndcg,@100': [0.5205794385019609, 0.4980202386931935], 'male': 0.5746, 'rmsle': 0.7214, 'cor': 0.4844}}, train: {'mrr': 0.9991, 'cor': 0.5608, 'loss': 0.0975}
2022-12-01 15:12:26 - INFO - epoch: 7, valid: {2011: {'mrr': 0.4288419783115387, 'hits@1,3,10': [0.31151023507118225, 0.49613499641418457, 0.6551045179367065], 'ndcg,@100': [0.5324533132106808, 0.5106670528113076], 'male': 0.5724, 'rmsle': 0.7224, 'cor': 0.4847}}, train: {'mrr': 0.9992, 'cor': 0.5625, 'loss': 0.0926}
2022-12-01 15:52:45 - INFO - epoch: 8, valid: {2011: {'mrr': 0.434378057718277, 'hits@1,3,10': [0.3183628022670746, 0.5027428269386292, 0.6562326550483704], 'ndcg,@100': [0.5364356544186454, 0.5139546772844006], 'male': 0.5712, 'rmsle': 0.7201, 'cor': 0.4857}}, train: {'mrr': 0.9993, 'cor': 0.5631, 'loss': 0.089}
2022-12-01 16:34:40 - INFO - epoch: 9, valid: {2011: {'mrr': 0.4410252869129181, 'hits@1,3,10': [0.3256630301475525, 0.5098520517349243, 0.6606438159942627], 'ndcg,@100': [0.5416616765191533, 0.5189678856549659], 'male': 0.5722, 'rmsle': 0.7191, 'cor': 0.4857}}, train: {'mrr': 0.9993, 'cor': 0.5649, 'loss': 0.0858}
2022-12-01 17:21:35 - INFO - epoch: 10, valid: {2011: {'mrr': 0.44491565227508545, 'hits@1,3,10': [0.32834315299987793, 0.5164538621902466, 0.6645297408103943], 'ndcg,@100': [0.5450328162037914, 0.5226056293181828], 'male': 0.5748, 'rmsle': 0.7212, 'cor': 0.4879}}, train: {'mrr': 0.9994, 'cor': 0.5656, 'loss': 0.0828}
2022-12-01 18:26:41 - INFO - epoch: 11, valid: {2011: {'mrr': 0.4488900601863861, 'hits@1,3,10': [0.3341391682624817, 0.5199099779129028, 0.6647087931632996], 'ndcg,@100': [0.5477305908936975, 0.5246179147812304], 'male': 0.5691, 'rmsle': 0.7199, 'cor': 0.4875}}, train: {'mrr': 0.9994, 'cor': 0.5659, 'loss': 0.0807}
2022-12-01 19:04:42 - INFO - epoch: 12, valid: {2011: {'mrr': 0.4572136700153351, 'hits@1,3,10': [0.3451700806617737, 0.526983380317688, 0.6663920879364014], 'ndcg,@100': [0.5540520385510913, 0.5308389723527991], 'male': 0.5663, 'rmsle': 0.7171, 'cor': 0.4887}}, train: {'mrr': 0.9994, 'cor': 0.567, 'loss': 0.0784}
2022-12-01 19:42:39 - INFO - epoch: 13, valid: {2011: {'mrr': 0.45588579773902893, 'hits@1,3,10': [0.342233270406723, 0.5259805917739868, 0.6694124341011047], 'ndcg,@100': [0.5535008138551055, 0.5308491487701651], 'male': 0.5718, 'rmsle': 0.7231, 'cor': 0.4877}}, train: {'mrr': 0.9994, 'cor': 0.5678, 'loss': 0.0763}
2022-12-01 20:20:32 - INFO - epoch: 14, valid: {2011: {'mrr': 0.46567031741142273, 'hits@1,3,10': [0.35638606548309326, 0.5346357822418213, 0.6690304279327393], 'ndcg,@100': [0.5603977414613441, 0.5369454049290465], 'male': 0.57, 'rmsle': 0.7189, 'cor': 0.4893}}, train: {'mrr': 0.9995, 'cor': 0.5688, 'loss': 0.0749}
2022-12-01 21:22:15 - INFO - epoch: 15, valid: {2011: {'mrr': 0.46822333335876465, 'hits@1,3,10': [0.35873788595199585, 0.5371905565261841, 0.6715673208236694], 'ndcg,@100': [0.5627181482547661, 0.5395563280167548], 'male': 0.57, 'rmsle': 0.7159, 'cor': 0.4891}}, train: {'mrr': 0.9995, 'cor': 0.5692, 'loss': 0.0734}
2022-12-01 21:59:58 - INFO - epoch: 16, valid: {2011: {'mrr': 0.47540441155433655, 'hits@1,3,10': [0.36803776025772095, 0.5426523089408875, 0.6744503974914551], 'ndcg,@100': [0.5685121655519015, 0.5456805164432023], 'male': 0.5708, 'rmsle': 0.7194, 'cor': 0.4899}}, train: {'mrr': 0.9995, 'cor': 0.5696, 'loss': 0.0719}
2022-12-01 22:38:46 - INFO - epoch: 17, valid: {2011: {'mrr': 0.474075049161911, 'hits@1,3,10': [0.3672080636024475, 0.5424911379814148, 0.6710599064826965], 'ndcg,@100': [0.5669532299570768, 0.5434820193692885], 'male': 0.5686, 'rmsle': 0.7158, 'cor': 0.4908}}, train: {'mrr': 0.9995, 'cor': 0.5699, 'loss': 0.0706}
2022-12-01 23:18:29 - INFO - epoch: 18, valid: {2011: {'mrr': 0.47244715690612793, 'hits@1,3,10': [0.36829444766044617, 0.5382649898529053, 0.6642850041389465], 'ndcg,@100': [0.5646979631457891, 0.5401167492440061], 'male': 0.5699, 'rmsle': 0.7208, 'cor': 0.4902}}, train: {'mrr': 0.9995, 'cor': 0.5709, 'loss': 0.0692}
2022-12-02 00:09:04 - INFO - epoch: 19, valid: {2011: {'mrr': 0.4739328622817993, 'hits@1,3,10': [0.36901670694351196, 0.5401452779769897, 0.6667203903198242], 'ndcg,@100': [0.5663130912773443, 0.5423189855726792], 'male': 0.5661, 'rmsle': 0.7129, 'cor': 0.4931}}, train: {'mrr': 0.9995, 'cor': 0.5708, 'loss': 0.0682}
2022-12-02 00:52:03 - INFO - epoch: 20, valid: {2011: {'mrr': 0.4775407910346985, 'hits@1,3,10': [0.37342190742492676, 0.5443177223205566, 0.6675620079040527], 'ndcg,@100': [0.5690266368362304, 0.5448131115266563], 'male': 0.5649, 'rmsle': 0.713, 'cor': 0.491}}, train: {'mrr': 0.9995, 'cor': 0.5714, 'loss': 0.0671}
2022-12-02 01:29:13 - INFO - epoch: 21, valid: {2011: {'mrr': 0.4823208749294281, 'hits@1,3,10': [0.37977901101112366, 0.5477200746536255, 0.6694482564926147], 'ndcg,@100': [0.57291400666027, 0.5489886362472193], 'male': 0.5713, 'rmsle': 0.7212, 'cor': 0.4917}}, train: {'mrr': 0.9996, 'cor': 0.5721, 'loss': 0.066}
2022-12-02 02:40:51 - INFO - epoch: 22, valid: {2011: {'mrr': 0.4747157692909241, 'hits@1,3,10': [0.36987030506134033, 0.5406765341758728, 0.6681350469589233], 'ndcg,@100': [0.5668400808179402, 0.5426459759072128], 'male': 0.5613, 'rmsle': 0.7096, 'cor': 0.4907}}, train: {'mrr': 0.9996, 'cor': 0.5722, 'loss': 0.065}
2022-12-02 03:27:13 - INFO - epoch: 23, valid: {2011: {'mrr': 0.47331738471984863, 'hits@1,3,10': [0.36920174956321716, 0.5393155813217163, 0.6643626093864441], 'ndcg,@100': [0.5654204984649699, 0.5409697946866309], 'male': 0.5663, 'rmsle': 0.7179, 'cor': 0.4937}}, train: {'mrr': 0.9996, 'cor': 0.5727, 'loss': 0.0642}
2022-12-02 04:04:58 - INFO - epoch: 24, valid: {2011: {'mrr': 0.47832995653152466, 'hits@1,3,10': [0.37641841173171997, 0.5435476899147034, 0.6648042798042297], 'ndcg,@100': [0.5690216004652975, 0.5441235770815465], 'male': 0.5648, 'rmsle': 0.7151, 'cor': 0.4929}}, train: {'mrr': 0.9996, 'cor': 0.5728, 'loss': 0.0632}
2022-12-02 04:42:55 - INFO - epoch: 25, valid: {2011: {'mrr': 0.47918701171875, 'hits@1,3,10': [0.3767944574356079, 0.5451414585113525, 0.6662249565124512], 'ndcg,@100': [0.5696461194914468, 0.5445148803026042], 'male': 0.5658, 'rmsle': 0.7159, 'cor': 0.4933}}, train: {'mrr': 0.9996, 'cor': 0.5736, 'loss': 0.0626}
2022-12-02 05:25:16 - INFO - epoch: 26, valid: {2011: {'mrr': 0.48274320363998413, 'hits@1,3,10': [0.38047143816947937, 0.5494869351387024, 0.6680932641029358], 'ndcg,@100': [0.5725575375457908, 0.5474437611905446], 'male': 0.5623, 'rmsle': 0.7105, 'cor': 0.4928}}, train: {'mrr': 0.9996, 'cor': 0.5734, 'loss': 0.0619}
2022-12-02 06:28:51 - INFO - epoch: 27, valid: {2011: {'mrr': 0.47974976897239685, 'hits@1,3,10': [0.37843000888824463, 0.5453563332557678, 0.6637119650840759], 'ndcg,@100': [0.5698740880349832, 0.5444707224304993], 'male': 0.5651, 'rmsle': 0.7144, 'cor': 0.4916}}, train: {'mrr': 0.9996, 'cor': 0.574, 'loss': 0.061}
2022-12-02 07:31:08 - INFO - epoch: 28, valid: {2011: {'mrr': 0.4757916033267975, 'hits@1,3,10': [0.372251957654953, 0.542873203754425, 0.6639089584350586], 'ndcg,@100': [0.5671849524344362, 0.5422128071943394], 'male': 0.5639, 'rmsle': 0.7116, 'cor': 0.4935}}, train: {'mrr': 0.9996, 'cor': 0.5744, 'loss': 0.0604}
2022-12-02 08:20:18 - INFO - epoch: 29, valid: {2011: {'mrr': 0.4764220714569092, 'hits@1,3,10': [0.3765258491039276, 0.5411481261253357, 0.6576712131500244], 'ndcg,@100': [0.5668416786386146, 0.5411658792413158], 'male': 0.5608, 'rmsle': 0.7098, 'cor': 0.4924}}, train: {'mrr': 0.9996, 'cor': 0.5747, 'loss': 0.0597}
2022-12-02 08:55:16 - INFO - epoch: 30, valid: {2011: {'mrr': 0.4790615439414978, 'hits@1,3,10': [0.3760363757610321, 0.5457264184951782, 0.6656280159950256], 'ndcg,@100': [0.5697016565068399, 0.5447132788886319], 'male': 0.5626, 'rmsle': 0.7111, 'cor': 0.4923}}, train: {'mrr': 0.9996, 'cor': 0.575, 'loss': 0.0589}
2022-12-02 09:44:26 - INFO - epoch: 31, valid: {2011: {'mrr': 0.4831613600254059, 'hits@1,3,10': [0.3831038177013397, 0.54744553565979, 0.6647565364837646], 'ndcg,@100': [0.572664374898496, 0.5475026667687121], 'male': 0.5651, 'rmsle': 0.7174, 'cor': 0.4917}}, train: {'mrr': 0.9996, 'cor': 0.5748, 'loss': 0.0584}
2022-12-02 10:21:08 - INFO - epoch: 32, valid: {2011: {'mrr': 0.48008254170417786, 'hits@1,3,10': [0.3797909617424011, 0.5452727675437927, 0.6622734069824219], 'ndcg,@100': [0.5697517548708703, 0.5439503824521157], 'male': 0.5614, 'rmsle': 0.7097, 'cor': 0.4943}}, train: {'mrr': 0.9996, 'cor': 0.5753, 'loss': 0.0577}
2022-12-02 11:00:48 - INFO - epoch: 33, valid: {2011: {'mrr': 0.47838708758354187, 'hits@1,3,10': [0.37844792008399963, 0.5428075194358826, 0.6590142846107483], 'ndcg,@100': [0.5681283801076717, 0.5421011027420992], 'male': 0.5633, 'rmsle': 0.711, 'cor': 0.4936}}, train: {'mrr': 0.9996, 'cor': 0.5754, 'loss': 0.0574}
2022-12-02 11:46:21 - INFO - epoch: 34, valid: {2011: {'mrr': 0.4786108434200287, 'hits@1,3,10': [0.3778510093688965, 0.5440312027931213, 0.6606855988502502], 'ndcg,@100': [0.5688014354667588, 0.5433574256415952], 'male': 0.5622, 'rmsle': 0.7117, 'cor': 0.4938}}, train: {'mrr': 0.9997, 'cor': 0.5751, 'loss': 0.0568}
2022-12-02 12:21:03 - INFO - epoch: 35, valid: {2011: {'mrr': 0.4827478528022766, 'hits@1,3,10': [0.3845005929470062, 0.5463770627975464, 0.6603513360023499], 'ndcg,@100': [0.5716996386363067, 0.5459797484123966], 'male': 0.5653, 'rmsle': 0.7161, 'cor': 0.4937}}, train: {'mrr': 0.9997, 'cor': 0.5758, 'loss': 0.0565}
2022-12-02 12:55:52 - INFO - epoch: 36, valid: {2011: {'mrr': 0.47850877046585083, 'hits@1,3,10': [0.37899109721183777, 0.5421509146690369, 0.6594201326370239], 'ndcg,@100': [0.5684352723585406, 0.542729571536394], 'male': 0.5601, 'rmsle': 0.7103, 'cor': 0.4957}}, train: {'mrr': 0.9997, 'cor': 0.576, 'loss': 0.0559}
2022-12-02 13:30:29 - INFO - epoch: 37, valid: {2011: {'mrr': 0.4794248342514038, 'hits@1,3,10': [0.38146230578422546, 0.5418763160705566, 0.6566326022148132], 'ndcg,@100': [0.568865952072068, 0.5428479786203645], 'male': 0.5565, 'rmsle': 0.7027, 'cor': 0.4934}}, train: {'mrr': 0.9997, 'cor': 0.5762, 'loss': 0.0555}
2022-12-02 14:05:00 - INFO - epoch: 38, valid: {2011: {'mrr': 0.47831037640571594, 'hits@1,3,10': [0.379707396030426, 0.5422523617744446, 0.6560057997703552], 'ndcg,@100': [0.5679550267357911, 0.5417979184162665], 'male': 0.558, 'rmsle': 0.7084, 'cor': 0.4946}}, train: {'mrr': 0.9997, 'cor': 0.5767, 'loss': 0.055}
2022-12-02 14:42:51 - INFO - epoch: 39, valid: {2011: {'mrr': 0.48448851704597473, 'hits@1,3,10': [0.3831038177013397, 0.5502450466156006, 0.6678963303565979], 'ndcg,@100': [0.5741864019784115, 0.5494196232211582], 'male': 0.5664, 'rmsle': 0.7162, 'cor': 0.4955}}, train: {'mrr': 0.9997, 'cor': 0.5768, 'loss': 0.0546}
2022-12-02 15:27:45 - INFO - epoch: 40, valid: {2011: {'mrr': 0.4821092188358307, 'hits@1,3,10': [0.38459011912345886, 0.5452966094017029, 0.657712996006012], 'ndcg,@100': [0.5709385067225196, 0.5447473423925046], 'male': 0.5594, 'rmsle': 0.7099, 'cor': 0.4935}}, train: {'mrr': 0.9997, 'cor': 0.577, 'loss': 0.0542}
2022-12-02 16:02:41 - INFO - epoch: 41, valid: {2011: {'mrr': 0.4833531081676483, 'hits@1,3,10': [0.38479307293891907, 0.5477200746536255, 0.6592828631401062], 'ndcg,@100': [0.5722585642645396, 0.5464588600373048], 'male': 0.5577, 'rmsle': 0.7036, 'cor': 0.4943}}, train: {'mrr': 0.9997, 'cor': 0.577, 'loss': 0.0536}
2022-12-02 17:00:15 - INFO - epoch: 42, valid: {2011: {'mrr': 0.47790178656578064, 'hits@1,3,10': [0.3795641362667084, 0.541374921798706, 0.6546986103057861], 'ndcg,@100': [0.567725030015992, 0.5416789645419678], 'male': 0.559, 'rmsle': 0.7072, 'cor': 0.4955}}, train: {'mrr': 0.9997, 'cor': 0.5774, 'loss': 0.0533}
2022-12-02 17:47:26 - INFO - epoch: 43, valid: {2011: {'mrr': 0.4807434380054474, 'hits@1,3,10': [0.3837186396121979, 0.5442699193954468, 0.6553611755371094], 'ndcg,@100': [0.569823501181482, 0.5435761567815486], 'male': 0.5579, 'rmsle': 0.7057, 'cor': 0.4936}}, train: {'mrr': 0.9997, 'cor': 0.5774, 'loss': 0.0531}
2022-12-02 18:22:06 - INFO - epoch: 44, valid: {2011: {'mrr': 0.47781214118003845, 'hits@1,3,10': [0.3801610469818115, 0.5411600470542908, 0.6528660655021667], 'ndcg,@100': [0.5673895639195652, 0.5412450401210452], 'male': 0.558, 'rmsle': 0.7057, 'cor': 0.4943}}, train: {'mrr': 0.9997, 'cor': 0.5775, 'loss': 0.0527}
2022-12-02 19:09:59 - INFO - epoch: 45, valid: {2011: {'mrr': 0.4824668765068054, 'hits@1,3,10': [0.38442298769950867, 0.5464964509010315, 0.6586859822273254], 'ndcg,@100': [0.5715489240711139, 0.5458663795793026], 'male': 0.5572, 'rmsle': 0.7066, 'cor': 0.4951}}, train: {'mrr': 0.9997, 'cor': 0.5774, 'loss': 0.0524}
2022-12-02 19:44:39 - INFO - epoch: 46, valid: {2011: {'mrr': 0.48461204767227173, 'hits@1,3,10': [0.3872404098510742, 0.5483587980270386, 0.6589605212211609], 'ndcg,@100': [0.5731777132916128, 0.5473857466058029], 'male': 0.5609, 'rmsle': 0.7079, 'cor': 0.4943}}, train: {'mrr': 0.9997, 'cor': 0.5778, 'loss': 0.0521}
2022-12-02 20:21:36 - INFO - epoch: 47, valid: {2011: {'mrr': 0.47839730978012085, 'hits@1,3,10': [0.38122355937957764, 0.5410764813423157, 0.6531108021736145], 'ndcg,@100': [0.5681107613587085, 0.5421814628169939], 'male': 0.5649, 'rmsle': 0.7163, 'cor': 0.4944}}, train: {'mrr': 0.9997, 'cor': 0.5786, 'loss': 0.0517}
